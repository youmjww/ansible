---
- hosts: nas

  vars:
    host_name: "nas"
  roles:
    - ../core
  tasks:
    - name: create user
      user:
        name: nas
        shell: /bin/bash

    - name: apt installs
      apt:
        name:
          - samba
        update_cache: true

    - name: samba config
      lineinfile:
        path: /etc/samba/smb.conf
        create: yes
        line: "{{ item }}"
      with_items:
        - "[nas]"
        - "  comment = Sample Share"
        - "  path = /home/nas"
        - "  public = yes"
        - "  writable = yes"
        - "  guest ok = yes"
        - "  guest only = yes"
        - "  force user = nas"
